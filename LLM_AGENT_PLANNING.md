# LLMé©±åŠ¨çš„å¤šAgentè§„åˆ’ç³»ç»Ÿ

## æ¦‚è¿°

æœ¬ç³»ç»Ÿå·²å‡çº§ä¸º**LLMé©±åŠ¨çš„æ™ºèƒ½å¤šAgentè§„åˆ’ç³»ç»Ÿ**ï¼Œæ”¯æŒï¼š
- **å¤æ‚å‚æ•°ä¼ é€’**ï¼šæ¯ä¸ªAgentè°ƒç”¨æ”¯æŒä»»æ„å‚æ•°Map
- **Actionå¤šåˆ†æ”¯**ï¼šæ¯ä¸ªAgentæ”¯æŒå¤šä¸ªactionæ–¹æ³•
- **ä¾èµ–å›¾è°ƒåº¦**ï¼šæ”¯æŒå¤æ‚çš„DAGä¾èµ–å…³ç³»
- **æ™ºèƒ½æ„å›¾è¯†åˆ«**ï¼šLLMè‡ªåŠ¨åˆ†æç”¨æˆ·æ„å›¾å¹¶è§„åˆ’æ‰§è¡Œæ­¥éª¤

## æ ¸å¿ƒç‰¹æ€§

### 1. å¤æ‚å‚æ•°æ”¯æŒ
æ¯ä¸ªstepæ”¯æŒä»»æ„å‚æ•°Mapï¼ŒLLMå¯è¾“å‡ºï¼š
```json
{
  "id": 1,
  "agent": "calculator",
  "action": "calculate",
  "params": {
    "expression": "25*8",
    "precision": 2,
    "format": "decimal"
  }
}
```

### 2. Actionå¤šåˆ†æ”¯
æ¯ä¸ªAgentæ”¯æŒå¤šä¸ªactionï¼š
- calculator: calculate, evaluate, solve
- weather: query, forecast, history
- translator: translate, detect, convert
- file: read, write, list, delete
- search: search, filter, sort
- time: current, convert, calculate

### 3. ä¾èµ–å›¾è°ƒåº¦
æ”¯æŒå¤æ‚çš„ä¾èµ–å…³ç³»ï¼š
```json
{
  "steps": [
    {"id": 1, "agent": "calculator", "action": "calculate", "params": {"expression": "25*8"}},
    {"id": 2, "agent": "weather", "action": "query", "params": {"location": "åŒ—äº¬"}},
    {"id": 3, "agent": "translator", "action": "translate", "params": {"text": "step:1", "target_language": "è‹±æ–‡"}, "depends_on": [1]},
    {"id": 4, "agent": "file", "action": "write", "params": {"content": "step:3", "filename": "result.txt"}, "depends_on": [3]}
  ]
}
```

## ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šç®€å•é¡ºåºæ‰§è¡Œ
```
è¾“å…¥ï¼šè®¡ç®—100çš„å¹³æ–¹æ ¹ï¼Œç„¶åç¿»è¯‘æˆè‹±æ–‡
```
LLMè¾“å‡ºï¼š
```json
{
  "description": "æ•°å­¦è®¡ç®—åç¿»è¯‘",
  "steps": [
    {"id": 1, "agent": "calculator", "action": "calculate", "params": {"expression": "sqrt(100)"}},
    {"id": 2, "agent": "translator", "action": "translate", "params": {"text": "step:1", "target_language": "è‹±æ–‡"}, "depends_on": [1]}
  ],
  "collaboration": "sequential"
}
```

### ç¤ºä¾‹2ï¼šå¹¶è¡Œæ‰§è¡Œ
```
è¾“å…¥ï¼šåŒæ—¶è®¡ç®—25ä¹˜ä»¥8å’ŒæŸ¥è¯¢åŒ—äº¬å¤©æ°”
```
LLMè¾“å‡ºï¼š
```json
{
  "description": "å¹¶è¡Œè®¡ç®—å’Œå¤©æ°”æŸ¥è¯¢",
  "steps": [
    {"id": 1, "agent": "calculator", "action": "calculate", "params": {"expression": "25*8"}},
    {"id": 2, "agent": "weather", "action": "query", "params": {"location": "åŒ—äº¬"}}
  ],
  "collaboration": "parallel"
}
```

### ç¤ºä¾‹3ï¼šå¤æ‚ä¾èµ–å›¾
```
è¾“å…¥ï¼šè®¡ç®—25ä¹˜ä»¥8ï¼ŒæŸ¥è¯¢åŒ—äº¬å¤©æ°”ï¼ŒæŠŠè®¡ç®—ç»“æœç¿»è¯‘æˆè‹±æ–‡ï¼ŒæŠŠå¤©æ°”ä¿¡æ¯å†™å…¥æ–‡ä»¶
```
LLMè¾“å‡ºï¼š
```json
{
  "description": "å¤æ‚å¤šæ­¥éª¤ä»»åŠ¡",
  "steps": [
    {"id": 1, "agent": "calculator", "action": "calculate", "params": {"expression": "25*8"}},
    {"id": 2, "agent": "weather", "action": "query", "params": {"location": "åŒ—äº¬"}},
    {"id": 3, "agent": "translator", "action": "translate", "params": {"text": "step:1", "target_language": "è‹±æ–‡"}, "depends_on": [1]},
    {"id": 4, "agent": "file", "action": "write", "params": {"content": "step:2", "filename": "weather.txt"}, "depends_on": [2]}
  ],
  "collaboration": "dag"
}
```

## æ‰§è¡Œæµç¨‹

### 1. ä»»åŠ¡åˆ†æ
- ç”¨æˆ·è¾“å…¥è‡ªç„¶è¯­è¨€ä»»åŠ¡
- LLMåˆ†ææ„å›¾ï¼Œè¾“å‡ºç»“æ„åŒ–JSON
- ç³»ç»Ÿè§£æJSONï¼Œæå–stepsã€paramsã€dependencies

### 2. è°ƒåº¦æ‰§è¡Œ
- **é¡ºåºæ‰§è¡Œ**ï¼šæŒ‰stepsé¡ºåºæ‰§è¡Œï¼Œæ”¯æŒ"ä¸Šä¸€æ­¥ç»“æœ"ä¾èµ–
- **å¹¶è¡Œæ‰§è¡Œ**ï¼šæ‰€æœ‰stepså¹¶å‘æ‰§è¡Œ
- **DAGæ‰§è¡Œ**ï¼šæŒ‰ä¾èµ–å…³ç³»æ‹“æ‰‘æ’åºæ‰§è¡Œ

### 3. å‚æ•°å¤„ç†
- è‡ªåŠ¨æ›¿æ¢"step:N"ä¸ºç¬¬Næ­¥çš„ç»“æœ
- æ”¯æŒ"ä¸Šä¸€æ­¥ç»“æœ"å…³é”®å­—æ›¿æ¢
- å‚æ•°Mapä¼ é€’ç»™Agentçš„actionæ–¹æ³•

### 4. Agentè°ƒç”¨
- ä¼˜å…ˆè°ƒç”¨`chat(action, params)`æ–¹æ³•
- å¦‚æœä¸å­˜åœ¨ï¼Œfallbackåˆ°`chat(input)`æ–¹æ³•
- è‡ªåŠ¨å°†paramsè½¬æ¢ä¸ºå­—ç¬¦ä¸²è¾“å…¥

## æ—¥å¿—è¾“å‡ºç¤ºä¾‹

### DAGæ‰§è¡Œæ—¥å¿—
```
ä»»åŠ¡åˆ›å»º: task-1
[æ—¶é—´] PENDING: ä»»åŠ¡å·²æäº¤ï¼Œç­‰å¾…æ‰§è¡Œ
[æ—¶é—´] ANALYZING: æ­£åœ¨åˆ†æä»»åŠ¡...
[æ—¶é—´] ä»»åŠ¡åˆ†æå®Œæˆ: å¤æ‚å¤šæ­¥éª¤ä»»åŠ¡
[æ—¶é—´] EXECUTING: æ­£åœ¨æ‰§è¡Œä»»åŠ¡...
[æ—¶é—´] å¼€å§‹DAGè°ƒåº¦æ‰§è¡Œï¼Œå…± 4 ä¸ªæ­¥éª¤
[æ—¶é—´] æ‰§è¡Œæ­¥éª¤ 1: calculator (calculate)
[æ—¶é—´] æ‰§è¡Œæ­¥éª¤ 2: weather (query)
[æ—¶é—´] æ‰§è¡Œæ­¥éª¤ 3: translator (translate)
[æ—¶é—´] æ‰§è¡Œæ­¥éª¤ 4: file (write)
[æ—¶é—´] ğŸ‰ DAGè°ƒåº¦æ‰§è¡Œå®Œæˆ
[æ—¶é—´] COMPLETED: ä»»åŠ¡æ‰§è¡Œå®Œæˆ
```

## æ‰©å±•æŒ‡å—

### 1. æ·»åŠ æ–°Agent
1. åœ¨`initializeAgents()`ä¸­æ·»åŠ æ–°Agent
2. åœ¨LLM promptä¸­æè¿°æ–°Agentçš„èƒ½åŠ›
3. å®ç°å¯¹åº”çš„Agentæ¥å£

### 2. æ·»åŠ æ–°Action
1. åœ¨Agentæ¥å£ä¸­æ·»åŠ æ–°æ–¹æ³•
2. åœ¨LLM promptä¸­æè¿°æ–°action
3. ç³»ç»Ÿä¼šè‡ªåŠ¨é€šè¿‡åå°„è°ƒç”¨

### 3. ä¼˜åŒ–Prompt
- è°ƒæ•´promptæ¨¡æ¿ï¼Œè®©LLMè¾“å‡ºæ›´ç¨³å®šçš„JSON
- æ·»åŠ æ›´å¤šç¤ºä¾‹ï¼Œæå‡æ„å›¾è¯†åˆ«å‡†ç¡®ç‡
- æ”¯æŒæ›´å¤æ‚çš„ä¾èµ–å…³ç³»æè¿°

## æŠ€æœ¯æ¶æ„

### æ ¸å¿ƒç»„ä»¶
- **EnhancedAgentOrchestrator**: ä¸»è°ƒåº¦å™¨
- **LlmTaskPlan**: ä»»åŠ¡è§„åˆ’å¯¹è±¡
- **LlmTaskStep**: æ‰§è¡Œæ­¥éª¤å¯¹è±¡
- **SpecializedAgent**: AgentåŒ…è£…å™¨

### æ‰§è¡Œæ¨¡å¼
- **Sequential**: é¡ºåºæ‰§è¡Œï¼Œæ”¯æŒä¸Šä¸€æ­¥ç»“æœä¾èµ–
- **Parallel**: å¹¶è¡Œæ‰§è¡Œï¼Œæ— ä¾èµ–å…³ç³»
- **DAG**: ä¾èµ–å›¾æ‰§è¡Œï¼Œæ”¯æŒå¤æ‚ä¾èµ–

### å‚æ•°ä¼ é€’
- **Map<String, Object>**: é€šç”¨å‚æ•°å®¹å™¨
- **step:N**: å¼•ç”¨ç¬¬Næ­¥ç»“æœ
- **ä¸Šä¸€æ­¥ç»“æœ**: é¡ºåºæ‰§è¡Œä¸­çš„ç»“æœä¼ é€’

## ä¼˜åŠ¿

1. **æ™ºèƒ½è§„åˆ’**: LLMè‡ªåŠ¨åˆ†ææ„å›¾ï¼Œæ— éœ€æ‰‹åŠ¨ç»´æŠ¤å…³é”®è¯
2. **çµæ´»æ‰©å±•**: åªéœ€ä¼˜åŒ–promptï¼Œæ— éœ€ä¿®æ”¹ä»£ç 
3. **å¤æ‚ä¾èµ–**: æ”¯æŒä»»æ„å¤æ‚çš„ä¾èµ–å…³ç³»
4. **å‚æ•°ä¸°å¯Œ**: æ”¯æŒä»»æ„å‚æ•°ç±»å‹å’Œæ•°é‡
5. **å‘åå…¼å®¹**: ä¿æŒåŸæœ‰æ¥å£å…¼å®¹æ€§

## ä½¿ç”¨å»ºè®®

1. **è¾“å…¥æè¿°**: ç”¨è‡ªç„¶è¯­è¨€æ¸…æ™°æè¿°ä»»åŠ¡éœ€æ±‚
2. **ä¾èµ–å…³ç³»**: æ˜ç¡®è¡¨è¾¾æ­¥éª¤é—´çš„ä¾èµ–å…³ç³»
3. **å‚æ•°æŒ‡å®š**: åœ¨è¾“å…¥ä¸­æ˜ç¡®æŒ‡å®šå‚æ•°ï¼ˆå¦‚åœ°ç‚¹ã€è¯­è¨€ç­‰ï¼‰
4. **ç›‘æ§æ—¥å¿—**: å…³æ³¨æ‰§è¡Œæ—¥å¿—ï¼Œäº†è§£ä»»åŠ¡æ‰§è¡Œè¿‡ç¨‹
5. **é”™è¯¯å¤„ç†**: ç³»ç»Ÿä¼šè‡ªåŠ¨fallbackåˆ°search agent

è¿™ä¸ªç³»ç»Ÿç°åœ¨å…·å¤‡äº†ä¼ä¸šçº§å¤šAgentåä½œçš„æ ¸å¿ƒèƒ½åŠ›ï¼Œå¯ä»¥å¤„ç†å¤æ‚çš„ä¸šåŠ¡åœºæ™¯å’Œç”¨æˆ·éœ€æ±‚ï¼ 